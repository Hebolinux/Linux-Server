# 防火墙

防火墙的主要职能是在网络层保障服务器的安全，服务器的安全问题根据不同层面结构划分有不同的解决方式：

- 硬件：保障服务器所处的环境，例如机柜上锁、温度检测、硬件检查
- 网络：iptables/firewalld
- 系统：去除服务器的公网IP、修改SSH端口号、SSH安全相关配置
- 服务：MySQL、Redis，及时更新服务版本，防止已知漏洞被人利用攻击
- 网站：SSL保障网站传输安全、WAF防火墙

firewalld只能实现IP/Port相关的限制，web相关的限制需要借助其他产品实现

## firewalld

CentOS7系统中集成了多款防火墙管理工具，默认启用firewalld动态防火墙管理器（无需重新加载服务使配置生效），firewalld支持CLI、GUI两种管理方式

```shell
# 3.获取当前默认使用的区域
[root@m01 ~]# firewall-cmd --get-default-zone

# 4.查看当前默认区域配置的所有规则
[root@m01 ~]# firewall-cmd --list-all --zone=public

# 5.拒绝所有主机ssh连接m01节点，仅允许宿主机访问
[root@m01 ~]# firewall-cmd --add-source=10.0.0.254/32 --zone=trusted --permanent
[root@m01 ~]# firewall-cmd --remove-service=ssh --zone=public --permanent
[root@m01 ~]# firewall-cmd --reload

# 6.输出所有活动域
[root@m01 ~]# firewall-cmd --get-active-zone
```

以上示例并无实际意义，因为在这个示例中，trusted区域的默认规则就是放行所有请求，所以从某种角度上看，限制来源IP并无意义。但是这个配置仍然产生了作用，**只要根据来源地址为另外区域设置一个规则（此处表现是为trusted区域设置了一个add-source来源地址），即可实现同时使用多区域规则**，来源IP是10.0.0.254时匹配trusted区域规则，除此以外都匹配public区域规则