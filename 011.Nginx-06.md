# Nginx代理

在无代理模式下，客户端直接向服务端发起请求，客户端访问请求规模较小的情况下这种直接响应的方式无可厚非，当客户端访问量过大时，一个服务端节点显然无法满足大量的访问请求，而多个服务端节点又会导致客户端不知道该访问‘谁’的问题，此时就需要代理服务

在互联网请求里面，客户端往往无法直接向服务端发起请求，而是通过代理服务实现客户端与服务端之间的通信

## Nginx代理服务支持的协议

1. Nginx作为代理服务，可支持的代理协议非常多

![Nginx代理协议](https://www.z4a.net/images/2023/02/22/Nginx86acccdfd3f6b891.png)

2. 如果将Nginx作为反向代理服务，常用到如下几种代理协议

![Nginx反向代理协议](https://www.z4a.net/images/2023/02/22/Nginx0edf6754c904a726.png)

## Nginx正向代理

Nginx的代理服务按照应用场景分为**正向代理**和**反向代理**，正向代理主要用于解决用户的“上网”问题，例如国内通过正常途径无法访问谷歌，此时仅需要一台能够访问到谷歌的代理服务器，客户端将自己的访问请求交给代理服务器，*由代理服务器进行DNS解析、访问谷歌*，然后将谷歌返回的数据包封装转发给客户端，这样就实现了“科学上网”

![Nginx正向代理](https://www.z4a.net/images/2023/02/22/Nginx.png)

正向代理类似家用WIFI的出口路由器，任何上网的请求都会交给出口路由器，由路由器与公网主机进行数据通信，路由器获取请求的资源后，根据设备MAC地址将资源返回到客户端

## Nginx反向代理

![Nginx反向代理](https://www.z4a.net/images/2023/02/22/Nginx0d6d56e6c5c07b33.png)

反向代理用于公司集群架构中，客户端的所有请求都会先到代理，由代理将客户端请求转交给后端Web集群，后端Web集群返回资源后再由代理服务器返回客户端

正向代理与反向代理的区别在于，正向代理的对象是客户端，为客户端服务、反向代理的对象是服务端，为服务端服务

### Nginx反向代理配置

1. 指令

```shell
Syntax: proxy_pass URL;
Default: -
Context: location, if in location, limit_except
```

